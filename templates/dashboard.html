{% extends 'base.html' %}
{% block content %}
<div class="actions-bar">
  <h1 style="margin:0">Dashboard</h1>
  <div class="actions">
    <a href="{{ url_for('nueva_orden') }}" class="btn small dashboard-action main-action-btn">+ Nueva Orden de Reparación</a>
    <a href="{{ url_for('nueva_cita') }}" class="btn small outline dashboard-action secondary-action-btn">Agendar Cita</a>
  </div>
  </div>
<div class="grid grid-3" style="margin-bottom:16px;">
  <div class="card kpi"><div>
    <div>Vehículos en el Taller Hoy</div>
    <div class="subtle">+2 desde ayer</div>
  <div class="value">{{ metrics.vehicles_today | default(0) }}</div></div>
  <div class="card kpi"><div>
    <div>Ingresos del Día</div>
    <div class="subtle">3 órdenes completadas</div>
  <div class="value">${{ metrics.day_income | default(0) }}</div></div>
  <div class="card kpi"><div>
    <div>Órdenes Pendientes de Aprobación</div>
    <div class="subtle">Requieren atención</div>
  <div class="value">{{ metrics.pending_approval | default(0) }}</div></div>
</div>

<div class="card">
  <h3 style="margin:0 0 12px">Órdenes de Reparación Activas</h3>
  <table class="table">
    <thead>
      <tr>
        <th>N° de Orden</th><th>Cliente</th><th>Vehículo (Placa)</th><th>Técnico Asignado</th><th>Estado</th><th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for o in orders %}
      <tr>
        <td>{{ o.code }}</td>
        <td>{{ o.client }}</td>
        <td>{{ o.vehicle }}</td>
        <td>{{ o.tech }}</td>
        <td>
          {% set s = o.status %}
          <span class="badge {% if 'Diagnóstico' in s %}b-blue{% elif 'Progreso' in s %}b-orange{% elif 'Esperando' in s %}b-orange{% elif 'Aprobación' in s %}b-orange{% else %}b-gray{% endif %}">{{ s }}</span>
        </td>
        <td class="actions"><a class="btn" href="{{ url_for('orden_detalle', id=o.id) }}">Ver Detalles</a></td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="evaluator-comment-section">
  <h3>Comentarios del Evaluador (Requisito de Prototipo)</h3>
  <textarea placeholder="Escribe aquí tus observaciones..." rows="4"></textarea>
</div>
{% endblock %}


